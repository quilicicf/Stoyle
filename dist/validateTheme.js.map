{"version":3,"sources":["../validateTheme.ts"],"sourcesContent":["import { BackgroundSimpleCode, ForegroundSimpleCode, DecorationCode } from './mod.ts';\n\nfunction checkCodeProperty (code: Record<string, any>, propertyName: string): boolean {\n  return !!code[ propertyName ] && typeof code[ propertyName ] === 'number';\n}\n\nfunction checkValidCodeOrRgb (color: any, enumValues: any[]): boolean {\n  return checkValidCode(color, enumValues)\n    || (color.red && color.green && color.blue);\n}\n\nfunction checkValidCode (color: any, enumValues: any[]): boolean {\n  return enumValues.includes(color);\n}\n\nfunction recursiveValidateTheme (referenceTheme: Record<string, any>, theme: Record<string, any>, location: string[], errors: string[]): string[] {\n  Object.entries(referenceTheme)\n    .forEach(([ key, referenceCode ]) => {\n      if (!referenceCode) { return; }\n      if (typeof referenceCode !== 'object') { return; }\n\n      const themeCode = theme[ key ];\n      const childLocation = [ ...location, key ];\n      if (!checkCodeProperty(referenceCode, 'color')\n        && !checkCodeProperty(referenceCode, 'backgroundColor')\n        && !checkCodeProperty(referenceCode, 'decoration')) {\n        if (!themeCode || typeof themeCode !== 'object') {\n          errors.push(`The theme should contain an object at ${JSON.stringify(childLocation)}`);\n          return;\n        }\n\n        recursiveValidateTheme(referenceCode, themeCode, childLocation, errors);\n        return;\n      }\n\n      if (!themeCode || typeof themeCode !== 'object') {\n        errors.push(`The theme should contain a style at ${JSON.stringify(childLocation)}`);\n        return;\n      }\n\n      const themeColor = themeCode.color;\n      if (themeColor && !checkValidCodeOrRgb(themeColor, Object.values(ForegroundSimpleCode))) {\n        errors.push(`The theme color is invalid at ${JSON.stringify(childLocation)}. It should be a ForegroundSimpleCode or ForegroundRgbCode`);\n      }\n\n      const themeBackgroundColor = themeCode.backgroundColor;\n      if (themeBackgroundColor && !checkValidCodeOrRgb(themeBackgroundColor, Object.values(BackgroundSimpleCode))) {\n        errors.push(`The theme backgroundColor is invalid at ${JSON.stringify(childLocation)}. It should be a BackgroundSimpleCode or BackgroundRgbCode`);\n      }\n\n      const themeDecoration = themeCode.decoration;\n      if (themeDecoration && !checkValidCode(themeDecoration, Object.values(DecorationCode))) {\n        errors.push(`The theme decoration is invalid at ${JSON.stringify(childLocation)}. It should be a DecorationCode`);\n      }\n    });\n\n  return errors;\n}\n\nexport function validateTheme (referenceTheme: Record<string, any>, theme: Record<string, any>): Record<string, any> {\n  const errors = recursiveValidateTheme(referenceTheme, theme, [], []);\n\n  if (errors.length) {\n    throw new Error(`[Theme errors]\\n* ${errors.join('\\n* ')}`);\n  }\n\n  return theme;\n}\n"],"names":["BackgroundSimpleCode","ForegroundSimpleCode","DecorationCode","checkCodeProperty","code","propertyName","checkValidCodeOrRgb","color","enumValues","checkValidCode","red","green","blue","includes","recursiveValidateTheme","referenceTheme","theme","location","errors","Object","entries","forEach","referenceCode","key","themeCode","childLocation","push","JSON","stringify","themeColor","values","themeBackgroundColor","backgroundColor","themeDecoration","decoration","validateTheme","length","Error","join"],"mappings":"AAAA,MAAM,GAAGA,oBAAoB,EAAEC,oBAAoB,EAAEC,cAAc,QAAQ,CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAE5EC,iBAAiB,CAAEC,IAAyB,EAAEC,YAAoB,EAAW,CAAC;IACrF,MAAM,GAAGD,IAAI,CAAEC,YAAY,KAAM,MAAM,CAACD,IAAI,CAAEC,YAAY,MAAO,CAAQ;AAC3E,CAAC;SAEQC,mBAAmB,CAAEC,KAAU,EAAEC,UAAiB,EAAW,CAAC;IACrE,MAAM,CAACC,cAAc,CAACF,KAAK,EAAEC,UAAU,KACjCD,KAAK,CAACG,GAAG,IAAIH,KAAK,CAACI,KAAK,IAAIJ,KAAK,CAACK,IAAI;AAC9C,CAAC;SAEQH,cAAc,CAAEF,KAAU,EAAEC,UAAiB,EAAW,CAAC;IAChE,MAAM,CAACA,UAAU,CAACK,QAAQ,CAACN,KAAK;AAClC,CAAC;SAEQO,sBAAsB,CAAEC,cAAmC,EAAEC,KAA0B,EAAEC,QAAkB,EAAEC,MAAgB,EAAY,CAAC;IACjJC,MAAM,CAACC,OAAO,CAACL,cAAc,EAC1BM,OAAO,CAAC,QAAQC,QAAoB,CAAC;+CAA1BC,GAAG,cAAED,aAAa;QAC5B,EAAE,GAAGA,aAAa,EAAE,CAAC;YAAC,MAAM;QAAE,CAAC;QAC/B,EAAE,EAAE,MAAM,CAACA,aAAa,KAAK,CAAQ,SAAE,CAAC;YAAC,MAAM;QAAE,CAAC;QAElD,GAAK,CAACE,SAAS,GAAGR,KAAK,CAAEO,GAAG;QAC5B,GAAK,CAACE,aAAa,sBAAQR,QAAQ,SAAb,CAAC;YAAcM,GAAG;QAAC,CAAC;QAC1C,EAAE,GAAGpB,iBAAiB,CAACmB,aAAa,EAAE,CAAO,YACvCnB,iBAAiB,CAACmB,aAAa,EAAE,CAAiB,sBAClDnB,iBAAiB,CAACmB,aAAa,EAAE,CAAY,cAAG,CAAC;YACrD,EAAE,GAAGE,SAAS,IAAI,MAAM,CAACA,SAAS,KAAK,CAAQ,SAAE,CAAC;gBAChDN,MAAM,CAACQ,IAAI,CAAE,CAAsC,wCAAgC,MAAA,CAA9BC,IAAI,CAACC,SAAS,CAACH,aAAa;gBACjF,MAAM;YACR,CAAC;YAEDX,sBAAsB,CAACQ,aAAa,EAAEE,SAAS,EAAEC,aAAa,EAAEP,MAAM;YACtE,MAAM;QACR,CAAC;QAED,EAAE,GAAGM,SAAS,IAAI,MAAM,CAACA,SAAS,KAAK,CAAQ,SAAE,CAAC;YAChDN,MAAM,CAACQ,IAAI,CAAE,CAAoC,sCAAgC,MAAA,CAA9BC,IAAI,CAACC,SAAS,CAACH,aAAa;YAC/E,MAAM;QACR,CAAC;QAED,GAAK,CAACI,UAAU,GAAGL,SAAS,CAACjB,KAAK;QAClC,EAAE,EAAEsB,UAAU,KAAKvB,mBAAmB,CAACuB,UAAU,EAAEV,MAAM,CAACW,MAAM,CAAC7B,oBAAoB,IAAI,CAAC;YACxFiB,MAAM,CAACQ,IAAI,CAAE,CAA8B,gCAAgC,MAA0D,CAAxFC,IAAI,CAACC,SAAS,CAACH,aAAa,GAAE,CAA0D;QACvI,CAAC;QAED,GAAK,CAACM,oBAAoB,GAAGP,SAAS,CAACQ,eAAe;QACtD,EAAE,EAAED,oBAAoB,KAAKzB,mBAAmB,CAACyB,oBAAoB,EAAEZ,MAAM,CAACW,MAAM,CAAC9B,oBAAoB,IAAI,CAAC;YAC5GkB,MAAM,CAACQ,IAAI,CAAE,CAAwC,0CAAgC,MAA0D,CAAxFC,IAAI,CAACC,SAAS,CAACH,aAAa,GAAE,CAA0D;QACjJ,CAAC;QAED,GAAK,CAACQ,eAAe,GAAGT,SAAS,CAACU,UAAU;QAC5C,EAAE,EAAED,eAAe,KAAKxB,cAAc,CAACwB,eAAe,EAAEd,MAAM,CAACW,MAAM,CAAC5B,cAAc,IAAI,CAAC;YACvFgB,MAAM,CAACQ,IAAI,CAAE,CAAmC,qCAAgC,MAA+B,CAA7DC,IAAI,CAACC,SAAS,CAACH,aAAa,GAAE,CAA+B;QACjH,CAAC;IACH,CAAC;IAEH,MAAM,CAACP,MAAM;AACf,CAAC;AAED,MAAM,UAAUiB,aAAa,CAAEpB,cAAmC,EAAEC,KAA0B,EAAuB,CAAC;IACpH,GAAK,CAACE,MAAM,GAAGJ,sBAAsB,CAACC,cAAc,EAAEC,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAEnE,EAAE,EAAEE,MAAM,CAACkB,MAAM,EAAE,CAAC;QAClB,KAAK,CAAC,GAAG,CAACC,KAAK,CAAE,CAAkB,oBAAsB,MAAA,CAApBnB,MAAM,CAACoB,IAAI,CAAC,CAAM;IACzD,CAAC;IAED,MAAM,CAACtB,KAAK;AACd,CAAC"}